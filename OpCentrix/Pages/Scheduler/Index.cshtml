@using OpCentrix.Models.ViewModels;
@model OpCentrix.Pages.Scheduler.IndexModel

@{
    ViewData["Title"] = "Scheduler";
}
<div id="scheduler-grid" class="grid grid-cols-[120px_repeat(3,_1fr)] auto-rows-[60px] gap-px bg-gray-200 text-sm">

    <!-- Header Row -->
    <div class="bg-white font-bold text-center flex items-center justify-center">Date / Printer</div>
    @foreach (var machine in Model.ViewModel.Machines)
    {
        <div class="bg-white font-bold text-center flex items-center justify-center">@machine</div>
    }

    @foreach (var date in Model.ViewModel.Dates)
    {
        <!-- Date label on the left -->
        <div class="bg-white text-center font-medium flex items-center justify-center">
            @date.ToString("ddd, MMM d")
        </div>

        @foreach (var machine in Model.ViewModel.Machines)
        {
            var jobsForCell = Model.ViewModel.Jobs
                .Where(j => j.MachineId == machine && j.ScheduledStart.Date == date.Date)
                .ToList();

            <partial name="_DayCell" model="new DayCellViewModel {
                Date = date,
                MachineId = machine,
                Jobs = jobsForCell
            }" />
        }
    }
</div>
